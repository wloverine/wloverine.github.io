<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><meta name="color-scheme" content="dark light"><meta name="author" content="wloverine"><meta name="description" content="To be the change you can see in the world"><meta name="keywords" content=""><title>Linux cluster setup</title><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="//at.alicdn.com/t/font_3242539_utq6ykfq7z.css"><link rel="stylesheet" light-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/default.min.css" dark-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/tokyo-night-dark.min.css"><link rel="stylesheet" href="https://fonts.font.im/css?family=Noto+Serif" as="font"><link href="/style/index.css" rel="stylesheet"><meta name="generator" content="Hexo 5.4.0"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}</style></head><body><header class="page-header"><nav><ul class="router-list"><li class="nav-item"> <a href="/">主页</a></li><li class="nav-item"> <a href="/archives/">归档</a></li><li class="nav-item"> <a href="/atom.xml">RSS</a></li></ul><div class="mode-switch"><span class="iconfont icon-DarkTheme"></span></div></nav></header><main><section class="main-content"><section class="post-page"><div class="title-bar"><h1>Linux cluster setup</h1><div class="post-info"><span>2022-04-12 17:17:26</span><span class="tags"><a href="/tags/linux/">#linux</a></span></div></div><article> <div class="content"><h1 id="搭建Linux集群"><a href="#搭建Linux集群" class="headerlink" title="搭建Linux集群"></a>搭建Linux集群</h1><ul>
<li>当前主力机是m1芯片的macbook pro，所以linux镜像用的是arm64位的centos7，虚拟机软件选用VMware Fusion。本次目标搭建三台虚拟机，实现网络互通。</li>
</ul>
<span id="more"></span>

<h2 id="搭建准备"><a href="#搭建准备" class="headerlink" title="搭建准备"></a>搭建准备</h2><ul>
<li>vmware</li>
<li>Centos7 arm64镜像</li>
<li>Royal TSX（用于管理SSH连接）</li>
</ul>
<h2 id="具体实施"><a href="#具体实施" class="headerlink" title="具体实施"></a>具体实施</h2><ol>
<li><p>直接把镜像拖入vmware，开始进行安装（不要选择最小化安装）。</p>
</li>
<li><p>正常开机之后，一般是无法正常联网，这个时候我们首先选择桥接模式的wifi模式，然后可以用<code>dhclient</code>来给当前虚拟机一个可用的动态ip，注意这个ip每次开机都会变化。也可以自己指定ip。</p>
</li>
<li><p>编辑网络配置文件</p>
<p>需要更改的地方是把BOOTPROTO=dhcp改为static，另外ONBOOT改为yes，然后添加IPADDR、NETMASK、GATEWAY、DNS1。网络可用的表现是虚拟机能正常上网，能和宿主机互相通信。</p>
<pre><code class="hljs shell">vim /etc/sysconfig/network-scripts/ifcfg-ens160</code></pre>

<pre><code class="hljs properties"><span class="hljs-attr">TYPE</span>=<span class="hljs-string">Ethernet</span>
<span class="hljs-attr">PROXY_METHOD</span>=<span class="hljs-string">none</span>
<span class="hljs-attr">BROWSER_ONLY</span>=<span class="hljs-string">no</span>
<span class="hljs-attr">BOOTPROTO</span>=<span class="hljs-string">static</span>
<span class="hljs-attr">DEFROUTE</span>=<span class="hljs-string">yes</span>
<span class="hljs-attr">IPV4_FAILURE_FATAL</span>=<span class="hljs-string">no</span>
<span class="hljs-attr">IPV6INIT</span>=<span class="hljs-string">yes</span>
<span class="hljs-attr">IPV6_AUTOCONF</span>=<span class="hljs-string">yes</span>
<span class="hljs-attr">IPV6_DEFROUTE</span>=<span class="hljs-string">yes</span>
<span class="hljs-attr">IPV6_FAILURE_FATAL</span>=<span class="hljs-string">no</span>
<span class="hljs-attr">NAME</span>=<span class="hljs-string">ens160</span>
<span class="hljs-attr">UUID</span>=<span class="hljs-string">60593f15-8470-433d-933c-c0a1cc25faa3</span>
<span class="hljs-attr">DEVICE</span>=<span class="hljs-string">ens160</span>
<span class="hljs-attr">ONBOOT</span>=<span class="hljs-string">yes</span>
<span class="hljs-attr">IPADDR</span>=<span class="hljs-string">192.168.1.201</span>
<span class="hljs-attr">NETMASK</span>=<span class="hljs-string">255.255.255.0</span>
<span class="hljs-attr">GATEWAY</span>=<span class="hljs-string">192.168.1.1</span>
<span class="hljs-attr">DNS1</span>=<span class="hljs-string">119.29.29.29</span></code></pre>

<pre><code class="hljs shell">systemctl restart network.service</code></pre></li>
<li><p>编辑hostname</p>
<pre><code class="hljs shell">vim /etc/hostname</code></pre></li>
<li><p>编辑hosts</p>
<pre><code class="hljs shell">vim /etc/hosts</code></pre></li>
<li><p>关闭防火墙</p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 临时关闭</span>
systemctl stop firewalld
<span class="hljs-meta">#</span><span class="bash"> 永久关闭</span>
systemctl disable firewalld.service</code></pre></li>
<li><p>至此，单台虚拟机就准备完毕，这个时候将其关机，然后创建完整克隆，然后再改下克隆机的ip，确保虚拟机之间可以互相通信。</p>
</li>
</ol>
</div></article><div class="copyright-wrapper"><p>原文作者:<a href="http://yoursite.com">wloverine</a></p><p>原文链接:<a href="http://yoursite.com/2022/04/12/Linux-cluster-setup/">Linux cluster setup</a></p><p>发表日期: 2022-04-12 17:17:26</p><p>更新日期: 2022-10-10 22:11:04</p><p>版权声明: 本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class="post-pager"><div class="prev"><a href="/2022/10/10/clashx%E7%99%BD%E5%90%8D%E5%8D%95/" title="clashx白名单">上一篇 clashx白名单</a></div><div class="next"> <a href="/2021/11/28/suantairousi/" title="蒜苔肉丝">下一篇 蒜苔肉丝</a></div></div><link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.css"/><script src="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.js"></script><div id="gitalk-container"></div><script>new Gitalk({
  clientID: '',
  clientSecret: '',
  repo: '博客仓库名称',
  owner: 'github username',
  admin: 'github username',
  id: location.pathname.substr(0, 48),
  distractionFreeMode: true,
  labels: ['Gitalk'],
  title: 'Linux cluster setup',
}).render('gitalk-container');</script></section></section></main><footer class="footer-page"><div><span>Powered by</span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a><span>| Theme</span><a target="_blank" rel="noopener" href="https://github.com/techmovie/hexo-theme-instapaper">instapaper</a></div></footer><script src="/scripts/dark.js"></script><script src="/scripts/post.js"></script></body></html>